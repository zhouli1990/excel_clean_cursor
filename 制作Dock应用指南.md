# 表格数据清洗工具 - Dock应用制作指南

## 准备工作

1. 已为您创建好了两个文件：
   - `run_flask_app.sh` - Flask应用启动脚本
   - `表格数据清洗工具.applescript` - AppleScript源代码

2. 确认`run_flask_app.sh`已设置执行权限（已完成）

## 创建应用步骤

### 1. 使用脚本编辑器创建应用

1. 打开"脚本编辑器"
   - 在Finder中，点击菜单"前往" > "应用程序" > "实用工具" > "脚本编辑器"
   - 或使用Spotlight搜索"脚本编辑器"

2. 打开AppleScript文件
   - 点击"文件" > "打开"
   - 选择项目目录中的`表格数据清洗工具.applescript`文件

3. 保存为应用程序
   - 点击"文件" > "导出..."
   - 在对话框中设置：
     - 文件格式: 选择"应用程序"
     - 名称: `表格数据清洗工具.app`
     - 位置: 选择项目目录
     - 签名: 不勾选（除非您有开发者证书）
     - 保持在后台: 不勾选
   - 点击"保存"按钮

### 2. 设置应用图标

创建应用图标有几种方式：

#### 方式一：使用现有图片作为图标
1. 在网络上下载一个理想的图标图片（推荐1024x1024像素的PNG）
2. 将图片转换为.icns格式：
   - 在Mac App Store下载"Image2icon"等工具
   - 或使用在线转换服务如：https://cloudconvert.com/png-to-icns
3. 在Finder中找到保存的`表格数据清洗工具.app`
4. 右键点击应用 > "显示简介"
5. 将图标文件拖到左上角的图标上

#### 方式二：使用自带图标
1. 在Finder中找到保存的`表格数据清洗工具.app`
2. 右键点击应用 > "显示简介"
3. 点击左上角的图标，按Command+C复制
4. 打开任何带图标的应用，复制其图标
5. 返回到您的应用简介窗口，选择左上角图标，按Command+V粘贴

### 3. 将应用添加到Dock

1. 在Finder中找到保存的`表格数据清洗工具.app`
2. 直接拖动应用到Dock栏
3. 或者右键点击应用 > "选项" > "保留在Dock中"

## 使用说明

- **启动应用**：点击Dock中的应用图标
- **关闭应用**：点击应用图标，然后按Command+Q或从菜单选择"退出表格数据清洗工具"

## 可能的问题及解决方案

1. **应用无法启动**
   - 检查`run_flask_app.sh`是否有执行权限
   - 确认Python和Flask正确安装
   - 查看`app.log`文件了解详细错误

2. **应用启动后立即退出**
   - 在终端中手动运行`./run_flask_app.sh`检查是否有错误
   - 确保项目依赖正确安装

3. **应用无法正常退出**
   - 手动使用`pkill -f "python app.py"`命令停止应用

4. **应用不显示正确的图标**
   - 删除应用从Dock上的图标，并重新添加
   - 清除图标缓存：`sudo rm -rf /var/folders/*/*/*/com.apple.dock.iconcache`，然后重启Dock：`killall Dock`

## 注意事项

- 第一次运行时，系统可能会提示安全警告，需要在"系统设置" > "安全与隐私"中允许应用运行
- 如果项目文件结构有变化，可能需要重新创建应用
- 该应用依赖于正确安装的Python环境和项目依赖 